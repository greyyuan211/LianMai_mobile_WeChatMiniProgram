(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/register-bind-phone"],{"082e":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={quiPage:function(){return Promise.all([i.e("common/vendor"),i.e("components/qui-page/qui-page")]).then(i.bind(null,"a983"))},quiInputCode:function(){return i.e("components/qui-input-code/qui-input-code").then(i.bind(null,"e359"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.i18n.t("user.bindPhone")),n=t.i18n.t("user.dear"),o=t.i18n.t("user.bindText"),s=t.i18n.t("user.phoneNumber"),a=t.i18n.t("modify.placeentercode"),r=t.i18n.t("user.bind");t.$mp.data=Object.assign({},{$root:{g0:i,g1:n,g2:o,g3:s,g4:a,g5:r}})},s=[]},"28c5":function(t,e,i){},"5bc5":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("dc1b")),o=a(i("c939")),s=i("0f20");function a(t){return t&&t.__esModule?t:{default:t}}var r={mixins:[n.default,o.default],data:function(){return{tit:!1,test:"",inshow:!1,inisIphone:!1,formeerro:"",btnContent:this.i18n.t("modify.sendverificode"),time:0,timer:"",disabled:!0,phoneNumber:"",verificationCode:"",isPaid:!1,captcha:null,captcha_ticket:"",captcha_rand_str:"",captchaResult:{},forum:{}}},onLoad:function(){var e=this;this.getForum(),this.$u.event.$on("captchaResult",(function(t){e.ticket=t.ticket,e.randstr=t.randstr,e.time=60,e.countdown(),e.sendSMS()})),this.$u.event.$on("closeChaReault",(function(){t.hideLoading()}))},onUnload:function(){this.$u.event.$off("captchaResult"),this.$u.event.$off("closeChaReault"),this.captcha&&this.captcha.destroy()},computed:{userInfo:function(){var e=t.getStorageSync("userInfo");return e},isBind:function(){var e=t.getStorageSync("isBind");return e}},methods:{changeinput:function(){var t=this;setTimeout((function(){t.phoneNumber=t.phoneNumber.replace(/[^\d]/g,"")}),30),11===this.phoneNumber.length?this.disabled=!1:this.disabled=!0},fourse:function(){this.inshow=!0},btndata:function(t){this.verificationCode=t},sendVerificationCode:function(){if(this.forum&&this.forum.qcloud&&this.forum.qcloud.qcloud_captcha){if(!this.ticket||!this.randstr)return this.toTCaptcha(),!1}else this.time=60,this.countdown(),this.sendSMS()},toTCaptcha:function(){wx.navigateToMiniProgram({appId:"wx5a3a7366fd07e119",path:"/pages/captcha/index",envVersion:"release",extraData:{appId:this.forum.qcloud.qcloud_captcha_app_id},success:function(){console.log("验证码成功打开")},fail:function(){t.hideLoading()}})},countdown:function(){this.time>1?(this.time-=1,this.btnContent="".concat(this.time).concat(this.i18n.t("modify.retransmission")),this.disabled=!0,this.timer=setTimeout(this.countdown,1e3),this.isGray=!0):1===this.time&&(this.btnContent=this.i18n.t("modify.sendverificode"),clearTimeout(this.timer),this.disabled=!1,this.isGray=!1)},sendSMS:function(){var t=this,e={_jv:{type:"sms/send"},mobile:this.phoneNumber,type:"login",captcha_ticket:this.ticket,captcha_rand_str:this.randstr};this.$store.dispatch("jv/post",e).then((function(e){e&&(t.ticket="",t.randstr="")})).catch((function(t){console.log(t)}))},handleClickBind:function(){""===this.phoneNumber?t.showToast({icon:"none",title:this.i18n.t("user.phonenumberEmpty"),duration:2e3}):""===this.verificationCode?t.showToast({icon:"none",title:this.i18n.t("user.verificationCodeEmpty"),duration:2e3}):(this.$store.dispatch("session/setPhone",this.phoneNumber),this.verifyPhoneNumber())},verifyPhoneNumber:function(){var e=this,i={data:{attributes:{mobile:this.phoneNumber,code:this.verificationCode,type:"login",register:1}}},n=function(i){e.$store.dispatch("session/verificationCodeh5Login",i).then((function(i){i&&i.access_token&&(e.logind(),t.showToast({title:"绑定成功",duration:2e3}),e.forum&&e.forum.set_site&&e.forum.set_site.site_mode!==s.SITE_PAY&&t.getStorage({key:"page",success:function(e){t.redirectTo({url:e.data})}}),e.forum&&e.forum.set_site&&e.forum.set_site.site_mode===s.SITE_PAY&&e.user&&!e.user.paid&&t.redirectTo({url:"/pages/site/info"}))})).catch((function(t){console.log(t)}))};this.refreshmpParams((function(){var t=e.$store.getters["session/get"]("params");t&&t.data&&t.data.attributes&&(i.data.attributes.js_code=t.data.attributes.js_code,i.data.attributes.noAES=1),n(i)}))},toggleBox:function(){this.inshow=!1}}};e.default=r}).call(this,i("543d")["default"])},"6c2b":function(t,e,i){"use strict";(function(t){i("8d7e");n(i("66fd"));var e=n(i("f386"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},"90f0":function(t,e,i){"use strict";i.r(e);var n=i("5bc5"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},e016:function(t,e,i){"use strict";var n=i("28c5"),o=i.n(n);o.a},f386:function(t,e,i){"use strict";i.r(e);var n=i("082e"),o=i("90f0");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("e016");var a,r=i("f0c5"),c=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"554b30e0",null,!1,n["a"],a);e["default"]=c.exports}},[["6c2b","common/runtime","common/vendor"]]]);