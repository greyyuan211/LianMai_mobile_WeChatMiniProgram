(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/register"],{"24ab":function(t,e,a){"use strict";(function(t){a("8d7e");r(a("66fd"));var e=r(a("c2d0"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"6cf5":function(t,e,a){"use strict";var r=a("bde2"),n=a.n(r);n.a},"80ad":function(t,e,a){"use strict";a.r(e);var r=a("f2d6"),n=a.n(r);for(var s in r)"default"!==s&&function(t){a.d(e,t,(function(){return r[t]}))}(s);e["default"]=n.a},bde2:function(t,e,a){},c2d0:function(t,e,a){"use strict";a.r(e);var r=a("f822"),n=a("80ad");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("6cf5");var i,o=a("f0c5"),u=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,"0b343388",null,!1,r["a"],i);e["default"]=u.exports},f2d6:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(a("a34a")),n=o(a("dc1b")),s=o(a("c939")),i=a("0f20");function o(t){return t&&t.__esModule?t:{default:t}}function u(t,e,a,r,n,s,i){try{var o=t[s](i),u=o.value}catch(c){return void a(c)}o.done?e(u):Promise.resolve(u).then(r,n)}function c(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var s=t.apply(e,a);function i(t){u(s,r,n,i,o,"next",t)}function o(t){u(s,r,n,i,o,"throw",t)}i(void 0)}))}}var d={mixins:[n.default,s.default],data:function(){return{username:"",password:"",repeatpasswd:"",site_mode:"",forum:{},isPaid:!1,captcha:null,captcha_ticket:"",captcha_rand_str:"",ticket:"",randstr:"",captchaResult:{}}},onLoad:function(){var e=this;this.getForum(),this.$u.event.$on("captchaResult",(function(t){e.ticket=t.ticket,e.randstr=t.randstr,e.addRegisterParams()})),this.$u.event.$on("closeChaReault",(function(){t.hideLoading()}))},onUnload:function(){this.$u.event.$off("captchaResult"),this.$u.event.$off("closeChaReault"),this.captcha&&this.captcha.destroy()},methods:{handleRegister:function(){""===this.username?t.showToast({icon:"none",title:this.i18n.t("user.usernameEmpty"),duration:2e3}):""===this.password?t.showToast({icon:"none",title:this.i18n.t("user.passwordEmpty"),duration:2e3}):this.password!==this.repeatpasswd?t.showToast({icon:"none",title:this.i18n.t("user.reenter"),duration:2e3}):this.forum&&this.forum.set_reg&&this.forum.set_reg.register_captcha?this.toTCaptcha():this.addRegisterParams()},addRegisterParams:function(){var e=this;return c(r.default.mark((function a(){var n,s,i,o;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n={data:{attributes:{username:e.username,password:e.password,register_type:e.forums&&e.forums.set_reg&&e.forums.set_reg.register_type||0}}},e.type||(s=t.getStorageSync("token"),""!==s&&(n.data.attributes.token=s)),e.forum&&e.forum.set_reg&&e.forum.set_reg.register_captcha&&(n.data.attributes.captcha_ticket=e.ticket,n.data.attributes.captcha_rand_str=e.randstr),i=t.getStorageSync("inviteCode"),""!==i&&(n.data.attributes.code=i),o=e,o.register(n,e.i18n.t("user.registerSuccess"));case 7:case"end":return a.stop()}}),a)})))()},toTCaptcha:function(e,a){wx.navigateToMiniProgram({appId:"wx5a3a7366fd07e119",path:"/pages/captcha/index",envVersion:"release",extraData:{appId:this.forum.qcloud.qcloud_captcha_app_id},success:function(){console.log("验证码成功打开")},fail:function(){t.hideLoading()}})},register:function(e,a){var r=this;this.$store.dispatch("session/h5Register",e).then((function(e){if(e&&201===e.statusCode&&e.data&&e.data.data.attributes.new_user&&"1"===r.forum.set_site.open_ext_fields)r.jump2RegisterExtendPage();else if(e&&e.data&&e.data.data&&e.data.data.id&&(r.logind(),r.forum&&r.forum.set_site&&r.forum.set_site.site_mode!==i.SITE_PAY&&t.getStorage({key:"page",success:function(e){t.redirectTo({url:e.data})}}),r.forum&&r.forum.set_site&&r.forum.set_site.site_mode===i.SITE_PAY&&r.user&&!r.user.paid&&t.redirectTo({url:"/pages/site/info"}),t.showToast({title:a,duration:2e3})),e&&e.data&&e.data.errors){if("401"===e.data.errors[0].status||"402"===e.data.errors[0].status||"500"===e.data.errors[0].status){var n=r.i18n.t("core.".concat(e.data.errors[0].code));t.showToast({icon:"none",title:n,duration:2e3})}if("403"===e.data.errors[0].status||"422"===e.data.errors[0].status){var s=r.i18n.t(e.data.errors[0].detail[0]);t.showToast({icon:"none",title:s,duration:2e3})}"content_banned"===e.data.errors[0].code&&t.showToast({icon:"none",title:r.i18n.t("core.username_banned"),duration:2e3})}})).catch((function(t){console.log(t)}))},jump2Login:function(){this.jump2LoginPage()}}};e.default=d}).call(this,a("543d")["default"])},f822:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return r}));var r={quiPage:function(){return Promise.all([a.e("common/vendor"),a.e("components/qui-page/qui-page")]).then(a.bind(null,"a983"))},quiRegistrationAgreement:function(){return a.e("components/qui-registration-agreement/qui-registration-agreement").then(a.bind(null,"0b1a"))}},n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.i18n.t("user.register")),r=t.i18n.t("user.username"),n=t.i18n.t("user.password"),s=t.i18n.t("user.repeatpasswd"),i=t.forum&&t.forum.set_reg&&"1"===t.forum.set_site.open_ext_fields?t.i18n.t("user.nextRegister"):null,o=t.forum&&t.forum.set_reg&&"1"===t.forum.set_site.open_ext_fields?null:t.i18n.t("user.register"),u=t.i18n.t("user.login");t.$mp.data=Object.assign({},{$root:{g0:a,g1:r,g2:n,g3:s,g4:i,g5:o,g6:u}})},s=[]}},[["24ab","common/runtime","common/vendor"]]]);