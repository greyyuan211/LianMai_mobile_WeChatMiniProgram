(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/qui-upload-audio/qui-upload-audio"],{"3eed":function(t,n,e){"use strict";e.r(n);var i=e("da6c"),o=e("7e73");for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);e("f75a");var a,r=e("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"3ee290e6",null,!1,i["a"],a);n["default"]=s.exports},"7a11":function(t,n,e){},"7e73":function(t,n,e){"use strict";e.r(n);var i=e("f582"),o=e.n(i);for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);n["default"]=o.a},da6c:function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return i}));var i={quiAudioCell:function(){return e.e("components/qui-audio-cell/qui-audio-cell").then(e.bind(null,"cbf7"))},quiIcon:function(){return e.e("components/qui-icon/qui-icon").then(e.bind(null,"d13f"))},quiToast:function(){return e.e("components/qui-toast/qui-toast").then(e.bind(null,"b091"))},quiLoading:function(){return e.e("components/qui-loading/qui-loading").then(e.bind(null,"52c8"))}},o=function(){var t=this,n=t.$createElement,e=(t._self._c,t.fileList.length>0||t.showAdd?null:t.i18n.t("discuzq.post.recording")),i=t.fileList.length>0||t.showAdd?null:t.i18n.t("discuzq.post.finish"),o=t.uploadLoading?t.i18n.t("discuzq.post.uploading"):null;t.$mp.data=Object.assign({},{$root:{g0:e,g1:i,g2:o}})},u=[]},f582:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=u(e("72db")),o=u(e("4cf1"));function u(t){return t&&t.__esModule?t:{default:t}}var a=wx.getRecorderManager(),r={props:{audioBeforeList:{type:Array,default:function(){return[]}}},data:function(){return{fileList:[],showAdd:!0,duration:"00:00:00",durationTime:0,timer:null,recorder:new i.default,isUpLoad:!0,uploadLoading:!1}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},watch:{audioBeforeList:{handler:function(t){this.fileList=t,this.$emit("change",this.fileList)},deep:!0,immediate:!0},durationTime:{handler:function(t){60===t&&this.stop()},deep:!0}},methods:{start:function(){var t=this,n={sampleRate:16e3,numberOfChannels:1,encodeBitRate:96e3,format:"mp3",frameSize:50};a.start(n),a.onStart((function(){t.showAdd=!1,t.chronoscope()})),a.onError((function(t){console.log(t)}))},stop:function(){var t=this;if(this.durationTime>1&&(clearInterval(this.timer),this.isUpLoad)){this.uploadLoading=!0,this.isUpLoad=!1;var n="".concat(this.userId,"_").concat(this.getCurrentTime(),".mp3");a.stop(),a.onStop((function(e){t.uploadAudio(e,n)}))}},uploadAudio:function(t,n){var e=this;o.default.start({mediaFile:t,getSignature:e.getSignature,mediaName:n,success:function(){},error:function(){e.$refs.toast.show({message:e.i18n.t("uploader.uploadFailed")})},progress:function(){},finish:function(t){e.postVideo(t.fileId,1,t.videoUrl,n)}})},getSignature:function(t){this.$store.dispatch("jv/get",["signature",{}]).then((function(n){t(n.signature)}))},showNum:function(t){return t<10?"0".concat(t):t},getCurrentTime:function(){var t=new Date,n=t.getFullYear(),e=this.showNum(t.getMonth()+1),i=this.showNum(t.getDate()),o=this.showNum(t.getHours()),u=this.showNum(t.getMinutes()),a=this.showNum(t.getSeconds());return"".concat(n).concat(e).concat(i).concat(o).concat(u).concat(a)},chronoscope:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.durationTime+=1;var n=t.showNum(parseInt(t.durationTime/60/60,10)),e=t.showNum(parseInt(t.durationTime/60,10)%60),i=t.showNum(t.durationTime%60);t.duration="".concat(n,":").concat(e,":").concat(i)}),1e3)},deleteItem:function(){this.$emit("audioDel")},blobToFile:function(t,n){return t.lastModifiedDate=new Date,t.name=n,t},audioPlayer:function(){var t=this;this.fileList.forEach((function(n){t.$refs["audio".concat(n.id)][0].audioPause()}))},postVideo:function(t,n,e,i){var o=this,u={_jv:{type:"thread/video"},file_id:t,media_url:e,type:n};this.$store.dispatch("jv/post",u).then((function(t){o.duration="00:00:00",o.durationTime=0,o.timer=null,o.uploadLoading=!1,o.isUpLoad=!0,o.fileList.push({fileName:i,url:t.media_url,id:t.file_id}),o.showAdd=!0}))}}};n.default=r},f75a:function(t,n,e){"use strict";var i=e("7a11"),o=e.n(i);o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/qui-upload-audio/qui-upload-audio-create-component',
    {
        'components/qui-upload-audio/qui-upload-audio-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("3eed"))
        })
    },
    [['components/qui-upload-audio/qui-upload-audio-create-component']]
]);
