(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/profile"],{2447:function(e,t,n){},4466:function(e,t,n){"use strict";(function(e){n("8d7e");o(n("66fd"));var t=o(n("d34d"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},5925:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var o={quiPage:function(){return Promise.all([n.e("common/vendor"),n.e("components/qui-page/qui-page")]).then(n.bind(null,"a983"))},quiCellItem:function(){return n.e("components/qui-cell-item/qui-cell-item").then(n.bind(null,"60f4"))},quiAvatar:function(){return Promise.all([n.e("common/vendor"),n.e("components/qui-avatar/qui-avatar")]).then(n.bind(null,"7a5a"))},quiUploader:function(){return Promise.all([n.e("common/vendor"),n.e("components/qui-uploader/qui-uploader")]).then(n.bind(null,"bb64"))},quiToast:function(){return n.e("components/qui-toast/qui-toast").then(n.bind(null,"b091"))},uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"78fd"))},quiAuthPhone:function(){return Promise.all([n.e("common/vendor"),n.e("components/qui-auth-phone/qui-auth-phone")]).then(n.bind(null,"26a7"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.profile.canEditUsername?e.i18n.t("profile.username"):null),o=e.profile.canEditUsername?null:e.i18n.t("profile.username"),i=e.i18n.t("profile.avatar"),s=e.forums.qcloud&&e.forums.qcloud.qcloud_sms?e.i18n.t("profile.mobile"):null,r=e.forums.qcloud&&e.forums.qcloud.qcloud_sms&&!e.profile.mobile?e.i18n.t("profile.bindingmobile"):null,a=e.i18n.t("profile.password"),u=e.profile.hasPassword?e.i18n.t("profile.modify"):null,l=e.profile.hasPassword?null:e.i18n.t("profile.setpassword"),c=e.forums.passport&&e.forums.passport.miniprogram_close?e.i18n.t("profile.wechat"):null,f=e.profile.realname&&e.forums.qcloud&&e.forums.qcloud.qcloud_faceid?e.i18n.t("profile.certification"):null,d=!e.profile.realname&&e.forums.qcloud&&e.forums.qcloud.qcloud_faceid?e.i18n.t("profile.certification"):null,p=!e.profile.realname&&e.forums.qcloud&&e.forums.qcloud.qcloud_faceid?e.i18n.t("profile.tocertification"):null,h=e.i18n.t("profile.signature"),m=e.i18n.t("profile.modify"),g=e.i18n.t("user.noBindTips"),v=e.i18n.t("user.changeBindTips");e.$mp.data=Object.assign({},{$root:{g0:n,g1:o,g2:i,g3:s,g4:r,g5:a,g6:u,g7:l,g8:c,g9:f,g10:d,g11:p,g12:h,g13:m,g14:g,g15:v}})},s=[]},"8eb8":function(e,t,n){"use strict";var o=n("2447"),i=n.n(o);i.a},aed0:function(e,t,n){"use strict";n.r(t);var o=n("ee8d"),i=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=i.a},d34d:function(e,t,n){"use strict";n.r(t);var o=n("5925"),i=n("aed0");for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("8eb8");var r,a=n("f0c5"),u=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,"d2583bc2",null,!1,o["a"],r);t["default"]=u.exports},ee8d:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("0f20"),i=a(n("7a36")),s=a(n("c939")),r=n("e114");function a(e){return e&&e.__esModule?e:{default:e}}var u=function(){n.e("components/uni-popup/uni-popup-dialog").then(function(){return resolve(n("ba2b"))}.bind(null,n)).catch(n.oe)},l={components:{uniPopupDialog:u},mixins:[i.default,s.default],data:function(){return{hasPassword:!1,header:{},formData:{},profile:{},name:"",show:!1,host:o.DISCUZ_REQUEST_HOST,userId:this.$store.getters["session/get"]("userId")}},onShow:function(){this.getUserInfo()},onLoad:function(){var t=e.getStorageSync("access_token");this.header={authorization:"Bearer ".concat(t)},this.formData={type:1}},methods:{bindPhone:function(){this.profile&&""===this.profile.mobile?this.$refs.authPhone.open():e.navigateTo({url:"/pages/modify/mobile?id=".concat(this.userId)})},bindWechat:function(){if("绑定"===this.name)return e.setStorage({key:"page",data:(0,r.getCurUrl)()}),e.setStorageSync("isSend",!0),e.setStorageSync("isBind",!0),void this.$store.getters["session/get"]("auth").open();"绑定"!==this.name&&this.name.indexOf("解绑")>-1&&this.$refs.noBind.open(),"绑定"!==this.name&&this.name.indexOf("换绑")>-1&&this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&(e.setStorage({key:"page",data:(0,r.getCurUrl)()}),e.setStorageSync("isSend",!1),this.$refs.changeBind.open())},clickNoBind:function(){var t=this;this.$store.dispatch("jv/delete","users/".concat(this.userId,"/wechat")).then((function(n){n&&n._jv&&n._jv.id&&(t.getUserInfo(),t.closeNoBind(),e.showToast({title:"解绑成功",duration:2e3}))}))},closeNoBind:function(){this.$refs.noBind.close()},clickChangeBind:function(){e.setStorageSync("isBind",!1),this.jump2LoginBindPage()},closeChangeBind:function(){this.$refs.changeBind.close()},getUserInfo:function(){var t=this,n={include:"groups,wechat"};this.$store.dispatch("jv/get",["users/".concat(this.userId),{params:n}]).then((function(n){if(n&&n._jv&&n._jv.id){t.profile=n,n&&n.wechat&&""!==n.wechat.min_openid?t.forums&&t.forums.set_reg&&2===t.forums.set_reg.register_type?t.name="".concat(n.wechat.nickname," (换绑)"):t.name="".concat(n.wechat.nickname," (解绑)"):t.name="绑定";var o={headimgurl:n.avatarUrl,username:n.username};e.setStorageSync("userInfo",o)}}))},uploadSuccess:function(t){if(e.hideLoading(),t.statusCode>=200&&t.statusCode<300){this.$refs.toast.show({message:this.i18n.t("profile.successfullyuploadedtheavatar")});var n=JSON.parse(t.data).data.attributes.avatarUrl;this.profile.avatarUrl=n,this.$set(this.$store.getters["jv/get"]("users/".concat(this.userId)),"avatarUrl",n)}else{var o=JSON.parse(t.data).errors[0].code;"upload_time_not_up"===o?this.$refs.toast.show({message:this.i18n.t("profile.uploadtimenotup")}):"validation_error"===o?this.$refs.toast.show({message:this.i18n.t("profile.validationerror")}):this.$refs.toast.show({message:o})}},changeAvatar:function(){this.$refs.upload.uploadClick()},chooseSuccess:function(){e.showLoading()},closeDialog:function(){this.$refs.authPhone.close()}}};t.default=l}).call(this,n("543d")["default"])}},[["4466","common/runtime","common/vendor"]]]);